<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: PLUMED Masterclass 22.13: SASA module and the application of PLUMED for implicit solvent simulations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.9.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('masterclass-22-13.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PLUMED Masterclass 22.13: SASA module and the application of PLUMED for implicit solvent simulations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Authors</dt><dd>Andrea Arsiccio </dd></dl>
<dl class="section date"><dt>Date</dt><dd>September 12, 2022</dd></dl>
<h1><a class="anchor" id="masterclass-22-13-aims"></a>
Aims</h1>
<p>This Masterclass is an introduction to the use of the SASA module of Plumed for the execution of implicit solvent simulations.</p>
<h1><a class="anchor" id="masterclass-22-13-lo"></a>
Objectives</h1>
<p>The objectives of this Masterclass are:</p><ul>
<li>Learn how the SASA module of PLUMED works</li>
<li>Learn how to run an implicit solvent simulation of a protein using PLUMED</li>
<li>Learn how to introduce the effect of temperature, pressure and osmolytes on protein stability in implicit solvent simulations</li>
<li>Understand the advantages and limitations of implicit solvent simulations using PLUMED</li>
</ul>
<h1><a class="anchor" id="masterclass-22-13-prereq"></a>
Prerequisites</h1>
<p>We assume that the person that will follow this tutorial is familiar with the Linux terminal, AMBER and basic functionality of PLUMED. Knowledge of the metadynamics enhanced sampling technique is recommended. Familiarity with gnuplot and xmgrace (or python with matplotlib) is recommended.</p>
<h1><a class="anchor" id="masterclass-22-13-install"></a>
Setting up PLUMED</h1>
<p>We will use AMBER and PLUMED to perform the calculations. Conda packages with the software required for this class have been prepared and you can install them following the instructions in <a href="https://github.com/plumed/masterclass-2022">this link</a>. Make sure to install the conda package for AMBER.</p>
<p>If you are compiling PLUMED on your own, you will need to install the SASA module manually by adding '&ndash;enable-modules=sasa' to your './configure' command when building PLUMED.</p>
<p>The data needed to run the exercises of this Masterclass can be found on <a href="https://github.com/andrea-arsiccio/masterclass-22-13">GitHub</a>. You can clone this repository locally on your machine using the following command:</p>
<pre class="fragment">git clone https://github.com/andrea-arsiccio/masterclass-22-13
</pre><p>You will also need a python script for the calculation of free energies of transfer, available on <a href="https://github.com/andrea-arsiccio/DeltaG-calculation">GitHub</a>.</p>
<h1><a class="anchor" id="masterclass-22-13-theory"></a>
Summary of theory</h1>
<p>The SASA module contains methods for the calculation of the solvent accessible surface area (SASA) of proteins. It can be used to include the SASA as a collective variable in metadynamics simulations, and for implicit solvent simulations.</p>
<p>There are two SASA functions that could be used:</p>
<p>SASA_HASEL: employs the algorithm described in <a class="el" href="citelist.html#CITEREF_Hasel1988">[65]</a> for the computation of the SASA.</p>
<p>SASA_LCPO: employs the algorithm described in <a class="el" href="citelist.html#CITEREF_Weiser1999">[143]</a> for the computation of the SASA.</p>
<p>The algorithm by Hasel et al. is about 2 to 3 times faster than the LCPO (linear combination of pairwise overlaps) algorithm, but slightly less accurate. Both algorithms have the advantage that apply simple analytical functions for the computation of the SASA, and because of this it is easy to compute their derivative, which is a necessary step to apply a bias based on the SASA to a molecular dynamics simulation.</p>
<p>The atoms for which the SASA is desired should be indicated with the keyword ATOMS, and a pdb file of the protein must be provided in input with the MOLINFO keyword. Two types of calculations are possible:</p>
<p>TOTAL: the total SASA is computed, which is the desired type of calculation if one wants to use the SASA as a CV in metadynamics simulations.</p>
<p>TRANSFER: in this case the free energy of transfer for the protein is computed according to the transfer model (TRANSFER). This keyword can be used, for instance, to compute the transfer of a protein to different temperatures, as detailed in <a class="el" href="citelist.html#CITEREF_Arsiccio-T-SASA-2021">[6]</a>, or to different pressures, as detailed in <a class="el" href="citelist.html#CITEREF_Arsiccio-P-SASA-2021">[5]</a>, or to different osmolyte solutions, as detailed in <a class="el" href="citelist.html#CITEREF_Arsiccio-C-SASA-2022">[7]</a>.</p>
<p>Using the protein SASA as a CV in metadynamics simulations, or monitoring the SASA on the fly during the simulation or while postprocessing a trajectory, is straightforward. The user, after having enabled the SASA module, can use the SASA functions mentioned above similarly to any other CV in PLUMED.</p>
<p>For instance, the following input tells plumed to print the total SASA for atoms 10 to 20 in a protein chain:</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested on v2.9" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1sasa" onclick='showPath("eg1","eg1sasa")'>sasa: </b><a href="https://www.plumed.org/doc-v2.9/user-doc/html/_s_a_s_a__h_a_s_e_l.html" style="color:green">SASA_HASEL</a> <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=TOTAL )</b>
The type of calculation you want to perform. <i></i></div></div>=TOTAL <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the SASA for. <i></i></div></div>=10-20 <div class="tooltip">NL_STRIDE<div class="right"><b>compulsory keyword </b>
The frequency with which the neighbor list for the calculation of SASA is updated.
<i></i></div></div>=10 <span style="display:none;" id="eg1sasa">The SASA_HASEL action with label <b>sasa</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-v2.9/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg1sasa">sasa</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p>This tutorial will focus on the use of the SASA module for running implicit solvent simulations with PLUMED. In implicit solvent simulations, the solvent is not any more described at atomistic/coarse-grained level, but is instead treated as a continuum and described as a mean field. The advantages are that the absence of the solvent degrees of freedom alleviates the computational cost, and the absence of viscous friction accelerates the exploration of the protein conformational space. However, the solvent effects are described less accurately. The degree of accuracy can be improved by using the concept of free energy of transfer, which is at the basis of the SASA module.</p>
<p>The common implementation of implicit solvent simulations relies on the computation of the free energy of a protein as the sum of three contributions: </p><p class="formulaDsp">
\[ G^{tot}= E^{vac}+G^{np}+G^{el} \]
</p>
<p> where \(E^{vac}\) is the molecule's energy in vacuum, which is the sum of internal contributions (bond and angle stretching, dihedral angles interactions) and van der Waals energy terms. \(G^{np}\) is the non-polar solvation contribution, i.e., the free energy of solvation for a molecule from which all charges have been removed. \(G^{el}\) is the electrostatic part, calculated as the free energy for turning on the partial charges in solution. This approach has been developed to describe (implicitly) the solvation of a protein in pure water, at ambient temperature (298 K) and pressure (1 atm).</p>
<p>The idea behind the SASA module is the addition of a free energy of transfer term \(G^{tr}(T,P,c)\): </p><p class="formulaDsp">
\[ G^{tot}= E^{vac}+G^{np}+G^{el}+G^{tr}(T,P,c) \]
</p>
<p> that describes the transfer of the protein to any given temperature \(T\), pressure \(P\) and concentration \(c\) of an osmolyte.</p>
<p>The free energy of transfer term has the following functional form: </p><p class="formulaDsp">
\[ G^{tr} = \sum_{j=1}^{n} g^{tr}_{j,sc} \alpha_{j,sc} +g^{tr}_{bb}\sum_{j=1}^{n} \alpha_{j, bb} \]
</p>
<p> where \(n\) is the number of residues in the protein and the global transfer free energy is obtained by summing the contributions given by the amino acid side chains ( \(g^{tr}_{j, sc}\)) and by the peptide backbone ( \(g^{tr}_{bb}\)).</p>
<p>Each contribution is weighed by the fractional solvent accessible surface area \(SASA_{j}\) of residue \(j\), </p><p class="formulaDsp">
\[ \alpha_{j}=\frac{SASA_{j}}{SASA_{j, Gly-X-Gly}} \]
</p>
<p> where \(SASA_{j, Gly-X-Gly}\) is the solvent accessibility of amino acid X in the tripeptide Gly-X-Gly, and X is the amino acid residue type \(j\).</p>
<p>The amino acid side chains ( \(g^{tr}_{j, sc}\)) and peptide backbone ( \(g^{tr}_{bb}\)) contributions to the transfer free energy are computed according to the mathematical derivation described in <a class="el" href="citelist.html#CITEREF_Arsiccio-T-SASA-2021">[6]</a> (for the effect of temperature), <a class="el" href="citelist.html#CITEREF_Arsiccio-P-SASA-2021">[5]</a> (for the effect of pressure), or <a class="el" href="citelist.html#CITEREF_Arsiccio-C-SASA-2022">[7]</a> (for the effect of osmolyte concentration).</p>
<p>Briefly, the tranfer free energy contributions describing the effect of temperatures have been derived by downloading a large set of Protein Data Bank (pdb) files resolved by nuclear magnetic resonance at different temperatures, and by computing the probability of different side chains/backbone groups to be surface exposed at different temperatures. The relation between energy and probability has then been exploited to compute the free energy of transfer contributions as a function of temperature.</p>
<p>The transfer free energy terms describing the effect of pressure have been obtained by computing three different contributions for each side chain/backbone group: 1) the elimination of a consistent fraction of the void volumes that are present within the native state upon unfolding, 2) the volume reduction of bound water molecules due to the increased SASA of a protein upon unfolding, and 3) the stabilizing excluded volume effect of a denser solvent.</p>
<p>Finally, the transfer free energy contributions as function of osmolyte type/concentrations have been obtained from experimental works, where solubility measurements of protein amino acids/peptide backbone models have been conducted in different osmolyte solutions and exploited to extract the difference in chemical potential between water and the osmolyte solution itself.</p>
<p>The interested user is invited to read the original works on this topic (<a class="el" href="citelist.html#CITEREF_Arsiccio-T-SASA-2021">[6]</a>, <a class="el" href="citelist.html#CITEREF_Arsiccio-P-SASA-2021">[5]</a> and <a class="el" href="citelist.html#CITEREF_Arsiccio-C-SASA-2022">[7]</a>) for a better understanding of the theory behind the free energy of transfer contributions.</p>
<p>When the TRANSFER keyword is used, a file with the free energy of transfer values for the sidechains ( \(g^{tr}_{j, sc}\)) and backbone ( \(g^{tr}_{bb}\)) atoms should be provided (using the keyword DELTAGFILE). Such file should have the following format:</p>
<pre class="fragment">----------------Sample DeltaG.dat file---------------------
ALA     0.711019999999962
ARG     -2.24832799999996
ASN     -2.74838799999999
ASP     -2.5626376
CYS     3.89864000000006
GLN     -1.76192
GLU     -2.38664400000002
GLY     0
HIS     -3.58152799999999
ILE     2.42634399999986
LEU     1.77233599999988
LYS     -1.92576400000002
MET     -0.262827999999956
PHE     1.62028800000007
PRO     -2.15598800000001
SER     -1.60934800000004
THR     -0.591559999999987
TRP     1.22936000000027
TYR     0.775547999999958
VAL     2.12779200000011
BACKBONE        1.00066920000002
-----------------------------------------------------------
</pre><p>where the second column is the free energy of transfer for each sidechain/backbone, in kJ/mol.</p>
<p>A Python script for the computation of free energy of transfer values to describe the effect of osmolyte concentration, temperature and pressure (according to <a class="el" href="citelist.html#CITEREF_Arsiccio-C-SASA-2022">[7]</a>, <a class="el" href="citelist.html#CITEREF_Arsiccio-T-SASA-2021">[6]</a> and <a class="el" href="citelist.html#CITEREF_Arsiccio-P-SASA-2021">[5]</a>) is freely available on <a href="https://github.com/andrea-arsiccio/DeltaG-calculation">GitHub</a>. The script automatically outputs a DeltaG.dat file compatible with the SASA module. Please have a look at the README file of this script to better understand its usage.</p>
<p>For instance, the following input tells plumed to compute the transfer free energy for the protein chain containing atoms 10 to 20. Such transfer free energy is then used as a bias in the simulation (e.g., implicit solvent simulations). The free energy of transfer values are read from a file called DeltaG.dat:</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested on v2.9" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2sasa" onclick='showPath("eg2","eg2sasa")'>sasa: </b><a href="https://www.plumed.org/doc-v2.9/user-doc/html/_s_a_s_a__h_a_s_e_l.html" style="color:green">SASA_HASEL</a> <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=TOTAL )</b>
The type of calculation you want to perform. <i></i></div></div>=TRANSFER <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the SASA for. <i></i></div></div>=10-20 <div class="tooltip">NL_STRIDE<div class="right"><b>compulsory keyword </b>
The frequency with which the neighbor list for the calculation of SASA is updated.
<i></i></div></div>=10 <div class="tooltip">DELTAGFILE<div class="right">a file containing the free energy of transfer values for backbone and sidechains
atoms. <i></i></div></div>=DeltaG.dat <span style="display:none;" id="eg2sasa">The SASA_HASEL action with label <b>sasa</b> calculates a single scalar value</span>
<b name="eg2bias" onclick='showPath("eg2","eg2bias")'>bias: </b><a href="https://www.plumed.org/doc-v2.9/user-doc/html/_b_i_a_s_v_a_l_u_e.html" style="color:green">BIASVALUE</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2sasa">sasa</b> <span style="display:none;" id="eg2bias">The BIASVALUE action with label <b>bias</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">bias.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">bias.sasa_bias</td><td>one or multiple instances of this quantity can be referenced elsewhere in the input file. these quantities will named with  the arguments of the bias followed by the character string _bias. These quantities tell the user how much the bias is due to each of the colvars. This particular component measures this quantity for the input CV named sasa</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-v2.9/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg2sasa">sasa</b>,<b name="eg2bias">bias.*</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
<p>If the DELTAGFILE is not provided, the SASA module computes the free energy of transfer values as if they had to take into account the effect of temperature according to approaches 2 or 3 (they differ in the mathematical model employed to extract free energies of transfer) in the paper <a class="el" href="citelist.html#CITEREF_Arsiccio-T-SASA-2021">[6]</a>. Please read and cite this paper if using the transfer model for computing the effect of temperature in implicit solvent simulations. For this purpose, the keyword APPROACH should be added, and set to either 2 or 3, as exemplified in the following input:</p>

<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/v2.9-passing-green.svg" alt="tested on v2.9" /></div><pre style="width: 97%;" class="fragment">
<b name="eg3sasa" onclick='showPath("eg3","eg3sasa")'>sasa: </b><a href="https://www.plumed.org/doc-v2.9/user-doc/html/_s_a_s_a__h_a_s_e_l.html" style="color:green">SASA_HASEL</a> <div class="tooltip">TYPE<div class="right"><b>compulsory keyword ( default=TOTAL )</b>
The type of calculation you want to perform. <i></i></div></div>=TRANSFER <div class="tooltip">ATOMS<div class="right">the group of atoms that you are calculating the SASA for. <i></i></div></div>=10-20 <div class="tooltip">NL_STRIDE<div class="right"><b>compulsory keyword </b>
The frequency with which the neighbor list for the calculation of SASA is updated.
<i></i></div></div>=10 <div class="tooltip">APPROACH<div class="right">either approach 2 or 3. <i></i></div></div>=2 <span style="display:none;" id="eg3sasa">The SASA_HASEL action with label <b>sasa</b> calculates a single scalar value</span>
<b name="eg3bias" onclick='showPath("eg3","eg3bias")'>bias: </b><a href="https://www.plumed.org/doc-v2.9/user-doc/html/_b_i_a_s_v_a_l_u_e.html" style="color:green">BIASVALUE</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg3sasa">sasa</b> <span style="display:none;" id="eg3bias">The BIASVALUE action with label <b>bias</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">bias.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">bias.sasa_bias</td><td>one or multiple instances of this quantity can be referenced elsewhere in the input file. these quantities will named with  the arguments of the bias followed by the character string _bias. These quantities tell the user how much the bias is due to each of the colvars. This particular component measures this quantity for the input CV named sasa</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-v2.9/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right">the input for this action is the scalar output from one or more other actions. <i></i></div></div>=<b name="eg3sasa">sasa</b>,<b name="eg3bias">bias.*</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <span style="display:none;" id="eg3">The PRINT action with label <b></b></span>
</pre>
<h1><a class="anchor" id="masterclass-22-13-system"></a>
The system: Refolding of a model peptide</h1>
<p>For this tutorial we will work on a model peptide called (AAQAA) \(_3\). (AAQAA) \(_3\) is a short peptide with known \(\alpha\)-helix structure. We will simulate this peptide starting from an unfolded conformation, and we will see in which conditions (of temperature, pressure, and solution composition) it folds back to a \(\alpha\)-helix, and which conditions promote instead an unfolded conformation.</p>
<div class="image">
<img src="masterclass-22-13-aaqaa_min.png" alt=""/>
<div class="caption">
Starting (unfolded) conformation of the model peptide used for the simulations.</div></div>
<p>We will perform the simulations in implicit solvent, using the AMBER ff03 force field.</p>
<p>For this tutorial, the following conditions will be explored:</p>
<p>1) 298 K, 1 bar, 0 M</p>
<p>2) 228 K (approach 2 in <a class="el" href="citelist.html#CITEREF_Arsiccio-T-SASA-2021">[6]</a>), 1 bar, 0 M</p>
<p>3) 348 K (approach 2 in <a class="el" href="citelist.html#CITEREF_Arsiccio-T-SASA-2021">[6]</a>), 1 bar, 0 M</p>
<p>4) 298 K, 1 bar, 10 M urea</p>
<p>5) 298 K, 3 kbar, 0 M</p>
<p>Each simulation will be performed for 5 ns.</p>
<h1><a class="anchor" id="masterclass-22-13-ex-1"></a>
Exercise 1: Simulation 1 at 298 K, 1 bar and 0 M osmolyte concentration</h1>
<p>For the exercises, we will need PLUMED and AMBER. For this purpose, you should first proceed to their installation using the provided conda packages:</p>
<pre class="fragment">#install the PLUMED environment
conda create --name plumed-masterclass-2022
conda activate plumed-masterclass-2022
conda install -c conda-forge plumed py-plumed numpy pandas matplotlib notebook mdtraj mdanalysis git


#install the AMBER environment
conda create --name plumed-masterclass-2022-amber
conda activate plumed-masterclass-2022-amber
conda install -c conda-forge ambertools


#stack the two environments together
conda activate plumed-masterclass-2022
conda activate --stack plumed-masterclass-2022-amber
export PLUMED_KERNEL=/your_path_here/plumed-masterclass-2022/lib/libplumedKernel.so
</pre><p>Then, you should download the folder with the input files for the exercises using the following command:</p>
<pre class="fragment">git clone https://github.com/andrea-arsiccio/masterclass-22-13
</pre><p>In order to perform exercise 1, cd to the folder SASA_module/01_298K. There you will find a number of files:</p>
<p>-aaqaa.prmtop: a topology file of the protein, described according to the AMBER ff03 force field.</p>
<p>-AAQAA_298.in: an input file for running the simulation through AMBER. I will go more in detail over this file in the following.</p>
<p>-aaqaa_min.ncrst/aaqaa_min.pdb: configuration files for the (unfolded) protein, which we will use as starting point for our simulations.</p>
<p>-histograms.py/picture_rg_alpha.gnu/script_rg_alpha.bash: files that we will use for the analyses and postprocessing of our trajectories.</p>
<p>-plumed.dat: PLUMED input file. I will go more in detail over this in the following.</p>
<p>The AAQAA_298.in file is an input AMBER file for carrying out our implicit solvent simulation, and it has the following aspect:</p>
<pre class="fragment">MD Generalise Born, no cut off
 &amp;cntrl
  imin = 0,
  igb = 5, gbsa = 1, extdiel = 78.4, ntpr = 1000, ntwx = 1000, ntwr = 1000,
  ntt = 3, gamma_ln = 1.0, ig = -1, nscm = 500,
  tempi = 298.0, temp0 = 298.0,
  nstlim = 2500000, dt = 0.002, ntc = 2, ntf = 2,
  cut = 9999.0, plumed = 1, plumedfile = 'plumed.dat'
 /
</pre><p>where the different commands have the following meaning:</p>
<p>imin = 0: we are running an MD simulation without performing energy minimization</p>
<p>igb = 5: we are using the model described in <a href="https://doi.org/10.1002/prot.20033">https://doi.org/10.1002/prot.20033</a> for computing the electrostatic interactions \(G^{el}\)</p>
<p>gbsa = 1: the \(G^{np}\) term is also computed</p>
<p>extdiel = 78.4: the dielectric constant of the solvent</p>
<p>ntpr = 1000: we print energy info every 1000 steps</p>
<p>ntwx = 1000: we print coordinates every 1000 steps</p>
<p>ntwr = 1000: we print the restart file every 1000 steps</p>
<p>ntt = 3: we apply Langevin dynamics</p>
<p>gamma_ln = 1.0: we set the collision frequency for Langevin dynamics</p>
<p>ig = -1: seed for pseudo-random number generator. -1 means that the random seed will be based on the current date and time</p>
<p>nscm = 500: translational/rotational COM motions will be removed every 500 steps</p>
<p>tempi = 298.0: initial temperature</p>
<p>temp0 = 298.0: reference temperature at which the system is to be kept</p>
<p>nstlim = 2500000: we will run the system for 2500000 steps</p>
<p>dt = 0.002: we will apply a 2 fs time step</p>
<p>ntc = 2: we will constrain bonds linking to a hydrogen</p>
<p>ntf = 2: bond interactions involving H-atoms will be omitted in force evaluations</p>
<p>cut = 9999.0: no cut off will be applied for nonbonded interactions</p>
<p>plumed = 1: we will run PLUMED together with AMBER</p>
<p>plumedfile = 'plumed.dat': the PLUMED file to read is called plumed.dat</p>
<p>The PLUMED input file plumed.dat has, instead, the following aspect:</p>
<pre class="fragment">MOLINFO MOLTYPE=protein STRUCTURE=aaqaa_min.pdb

# radius of gyration
rgyr: GYRATION TYPE=RADIUS ATOMS=1-174

# antiparallel beta
ab: ANTIBETARMSD RESIDUES=all LESS_THAN={RATIONAL R_0=0.08 NN=8 MM=12} STRANDS_CUTOFF=1

# parallel beta
pb: PARABETARMSD RESIDUES=all LESS_THAN={RATIONAL R_0=0.08 NN=8 MM=12} STRANDS_CUTOFF=1

# alpha helix
alfa: ALPHARMSD RESIDUES=all LESS_THAN={RATIONAL R_0=0.08 NN=8 MM=12}


PRINT ... 
 ARG=rgyr,ab.lessthan,pb.lessthan,alfa.lessthan
 STRIDE=1000
 FILE=COLVAR
... PRINT</pre><p>We are providing PLUMED with a protein structure (aaqaa_min.pdb) in input using the MOLINFO keyword. We are then computing the radius of gyration, parallel/antiparallel beta-sheet content and alpha-helix content of the protein, and we are printing this info to a file called COLVAR every 1000 integration steps. (AAQAA) \(_3\) should fold as a alpha-helix, but we are monitoring also the parallel/antiparallel beta-sheet content in order to identify potential cases of misfolding.</p>
<p>In this first example, we are simulating (AAQAA) \(_3\) in pure water at 298 K and ambient pressure, so we do not need to add the free energy of transfer term \(G^{tr}(T,P,c)\), and the SASA module is not even called in the PLUMED file. However, for exercises 2-5, you will need to use the SASA module to include the effect of temperature/pressure/urea concentration on protein stability.</p>
<p>To run the simulation, just type the command: </p><pre class="fragment">sander -O -i AAQAA_298.in -o aaqaa-MD.out -c aaqaa_min.ncrst -p aaqaa.prmtop -r aaqaa-MD.ncrst -x aaqaa-MD.nc &gt;&amp; logfile
</pre><p>The simulation should take 1-2 hours on a common laptop, so you should not need a cluster for this masterclass.</p>
<p>At the end of the simulation, you will have a COLVAR file that lists the evolution of radius of gyration and secondary structure content of the protein as function of time. Try to plot the columns of the COLVAR file versus time. Does the protein fold? If yes, how fast is the process? Do you think the process would be equally fast in explicit solvent?</p>
<p>Here is the evolution of the helical content of (AAQAA) \(_3\) over time during the simulation:</p>
<div class="image">
<img src="masterclass-22-13-tvsalpha.png" alt=""/>
<div class="caption">
Evolution of helical content over time during the simulation of exercise 1.</div></div>
<p>You can also use the script_rg_alpha.bash file provided to have a 2D representation of the conformational space explored by the protein during the simulation. Just type:</p>
<pre class="fragment">chmod +x script_rg_alpha.bash
./script_rg_alpha.bash COLVAR
</pre><p>The script generates a file called normFEL.dat that can be visualized in gnuplot using the picture_rg_alpha.gnu script provided. You should obtain something similar to:</p>
<div class="image">
<img src="masterclass-22-13-FES_rg_alpha.png" alt=""/>
<div class="caption">
Free energy surface showing radius of gyration and helical content of the protein during the simulation of exercise 1.</div></div>
<h1><a class="anchor" id="masterclass-22-13-ex-2-5"></a>
Exercises 2-5: Introducing the free energy of transfer contribution to implicit solvent simulations</h1>
<p>Using the learnings from the theoretical part of this masterclass and exercise 1, you should now be able to autonomously run exercises 2-5. The difference now is that you need to employ free energy of transfer contributions to simulate the solution conditions of exercises 2-5. Exercises 2 and 3 explore extreme (cold and hot) values of temperature. Exercise 4 includes the presence of a potent denaturant (urea), and exercise 5 is performed at a high pressure value.</p>
<p>This means that you will need to use the SASA module, as described in the thoretical summary, to introduce the effect of temperature, pressure and osmolyte concentration within the implicit solvent simulation.</p>
<p>The folder that you downloaded from <a href="https://github.com/andrea-arsiccio/masterclass-22-13">GitHub</a> contains 5 subfolders, one for each exercise. In each subfolder, every file is ready to use, with the only exception of the plumed.dat file, that you will need to write autonomously using the template employed in exercise 1. Specifically, please monitor for each exercise the radius of gyration and secondary structure content (alpha-helix, parallel and antiparalle beta-sheet) of the protein, and print this information to a file called COLVAR. You will also need to add a SASA_HASEL (hint: use SASA_HASEL instead of SASA_LCPO, as the algorithm by Hasel et al. is faster) and a BIASVALUE section to the plumed.dat file, as discussed in the theoretical section.</p>
<p>You will need to perform the following steps:</p>
<p>-install the software (PLUMED, AMBER)</p>
<p>-clone the GitHub folder with input files: git clone <a href="https://github.com/andrea-arsiccio/masterclass-22-13">https://github.com/andrea-arsiccio/masterclass-22-13</a></p>
<p>-write a PLUMED file in each subfolder according to the example of Exercise 1 (hint: use the DeltaG-calculation.py script if needed! The README for the script is available on <a href="https://github.com/andrea-arsiccio/DeltaG-calculation">GitHub</a>, please have a look into it)</p>
<p>-Run the simulations using the command: sander -O -i AAQAA_%%%.in -o aaqaa-MD.out -c aaqaa_min.ncrst -p aaqaa.prmtop -r aaqaa-MD.ncrst -x aaqaa-MD.nc &gt;&amp; logfile</p>
<p>-Analyze the trajectories as already done during exercise 1 (plot the COLVAR columns versus time, and use the script_rg_alpha.bash file to get a representation of the conformational space explored)</p>
<p>You should ask yourself the following questions:</p>
<p>-what would you expect to occur at the protein structure at extreme values of temperature/pressure/urea concentration? Are your expections reflected in the simulation outputs?</p>
<p>-would you observe similar phenomena also in 5-ns-long explicit solvent calculations?</p>
<h1><a class="anchor" id="masterclass-22-13-thoughts"></a>
Final thoughts</h1>
<p>Through this tutorial we have learnt that the SASA module of PLUMED implements two algorithms for the computation of the SASA (the faster algorithm by Hasel et al., and the more accurate LCPO algorithm).</p>
<p>We have found out that the SASA module can be used for introducing the SASA as a collective variable or for monitoring the SASA, but it can furthermore be employed to perform implicit solvent MD simulations.</p>
<p>Implicit solvent simulations with the SASA module are based on the concept of free energy of transfer (where the 'transfer' occurs from pure water at ambient temperature and pressure to an osmolyte solution at any desired value of temperature and pressure).</p>
<p>Implicit solvent simulations have the advantage, compared to their explicit solvent counterpart, to speed up conformational transitions, and allow a faster exploration of conformational space.</p>
<p>NOTE: The Masterclass files with the solutions to the exercises are also avilable on <a href="https://github.com/andrea-arsiccio/masterclass-22-13-results">GitHub</a>, but please do the exercises on your own before checking on the results! </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
